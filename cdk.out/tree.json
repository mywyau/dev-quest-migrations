{"version":"tree-0.1","tree":{"id":"App","path":"","children":{"FlywayMigrationStack":{"id":"FlywayMigrationStack","path":"FlywayMigrationStack","children":{"Vpc":{"id":"Vpc","path":"FlywayMigrationStack/Vpc","children":{"PublicSubnetSubnet1":{"id":"PublicSubnetSubnet1","path":"FlywayMigrationStack/Vpc/PublicSubnetSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"PublicSubnetSubnet2":{"id":"PublicSubnetSubnet2","path":"FlywayMigrationStack/Vpc/PublicSubnetSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"PrivateSubnetSubnet1":{"id":"PrivateSubnetSubnet1","path":"FlywayMigrationStack/Vpc/PrivateSubnetSubnet1","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"PrivateSubnetSubnet2":{"id":"PrivateSubnetSubnet2","path":"FlywayMigrationStack/Vpc/PrivateSubnetSubnet2","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}}},"constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"Cluster":{"id":"Cluster","path":"FlywayMigrationStack/Cluster","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"DbSecret":{"id":"DbSecret","path":"FlywayMigrationStack/DbSecret","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":[]}},"FlywayMigrationTask":{"id":"FlywayMigrationTask","path":"FlywayMigrationStack/FlywayMigrationTask","children":{"FlywayRepo":{"id":"FlywayRepo","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayRepo","constructInfo":{"fqn":"aws-cdk-lib.aws_ecr.RepositoryBase","version":"2.196.1","metadata":[]}},"FlywayTaskDef":{"id":"FlywayTaskDef","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef","children":{"TaskRole":{"id":"TaskRole","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/TaskRole","children":{"ImportTaskRole":{"id":"ImportTaskRole","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/TaskRole/ImportTaskRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/TaskRole/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.196.1"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/TaskRole/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/TaskRole/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:us-east-1:890742562318:secret:devquest-db-credentials-??????"}],"Version":"2012-10-17"},"policyName":"FlywayMigrationTaskFlywayTaskDefTaskRoleDefaultPolicy2C328C9C","roles":[{"Ref":"FlywayMigrationTaskFlywayTaskDefTaskRole9AE691E4"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.196.1","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]}]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.196.1","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"}},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]}]}},"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::ECS::TaskDefinition","aws:cdk:cloudformation:props":{"containerDefinitions":[{"essential":true,"image":{"Fn::Join":["",["890742562318.dkr.ecr.us-east-1.",{"Ref":"AWS::URLSuffix"},"/flyway-migrations:latest"]]},"name":"FlywayContainer","logConfiguration":{"logDriver":"awslogs","options":{"awslogs-group":{"Ref":"FlywayMigrationTaskFlywayLogGroupA603F567"},"awslogs-stream-prefix":"flyway","awslogs-region":"us-east-1"}},"environment":[{"name":"FLYWAY_URL","value":"jdbc:postgresql://devquestbackendstack-databasedevquestpostgres27060-hdmoes47swff.c41ee8yywtgf.us-east-1.rds.amazonaws.com:5432/dev_quest_db"},{"name":"FLYWAY_USER","value":"dev_quest_user"}],"secrets":[{"name":"FLYWAY_PASSWORD","valueFrom":"arn:aws:secretsmanager:us-east-1:890742562318:secret:devquest-db-credentials:password::"}]}],"cpu":"256","executionRoleArn":{"Fn::GetAtt":["FlywayMigrationTaskFlywayTaskDefExecutionRole4A3CC15E","Arn"]},"family":"flyway-migration-task","memory":"512","networkMode":"awsvpc","requiresCompatibilities":["FARGATE"],"taskRoleArn":{"Fn::GetAtt":["FlywayMigrationTaskFlywayTaskDefTaskRole9AE691E4","Arn"]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.CfnTaskDefinition","version":"2.196.1"}},"FlywayContainer":{"id":"FlywayContainer","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/FlywayContainer","constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.ContainerDefinition","version":"2.196.1"}},"ExecutionRole":{"id":"ExecutionRole","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/ExecutionRole","children":{"ImportExecutionRole":{"id":"ImportExecutionRole","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/ExecutionRole/ImportExecutionRole","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":["*"]}},"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/ExecutionRole/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Role","aws:cdk:cloudformation:props":{"assumeRolePolicyDocument":{"Statement":[{"Action":"sts:AssumeRole","Effect":"Allow","Principal":{"Service":"ecs-tasks.amazonaws.com"}}],"Version":"2012-10-17"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnRole","version":"2.196.1"}},"DefaultPolicy":{"id":"DefaultPolicy","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/ExecutionRole/DefaultPolicy","children":{"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDef/ExecutionRole/DefaultPolicy/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::IAM::Policy","aws:cdk:cloudformation:props":{"policyDocument":{"Statement":[{"Action":["ecr:BatchCheckLayerAvailability","ecr:BatchGetImage","ecr:GetDownloadUrlForLayer"],"Effect":"Allow","Resource":"arn:aws:ecr:us-east-1:890742562318:repository/flyway-migrations"},{"Action":"ecr:GetAuthorizationToken","Effect":"Allow","Resource":"*"},{"Action":["logs:CreateLogStream","logs:PutLogEvents"],"Effect":"Allow","Resource":{"Fn::GetAtt":["FlywayMigrationTaskFlywayLogGroupA603F567","Arn"]}},{"Action":["secretsmanager:DescribeSecret","secretsmanager:GetSecretValue"],"Effect":"Allow","Resource":"arn:aws:secretsmanager:us-east-1:890742562318:secret:devquest-db-credentials-??????"}],"Version":"2012-10-17"},"policyName":"FlywayMigrationTaskFlywayTaskDefExecutionRoleDefaultPolicy6B971AB7","roles":[{"Ref":"FlywayMigrationTaskFlywayTaskDefExecutionRole4A3CC15E"}]}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.CfnPolicy","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Policy","version":"2.196.1","metadata":["*",{"attachToRole":["*"]},{"attachToRole":["*"]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]},{"addStatements":[{}]}]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_iam.Role","version":"2.196.1","metadata":[{"assumedBy":{"principalAccount":"*","assumeRoleAction":"*"},"roleName":"*"},{"addToPrincipalPolicy":[{}]},{"attachInlinePolicy":["*"]},{"attachInlinePolicy":["*"]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]},{"addToPrincipalPolicy":[{}]}]}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ecs.FargateTaskDefinition","version":"2.196.1","metadata":["*","*","*","*","*","*"]}},"FlywayLogGroup":{"id":"FlywayLogGroup","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayLogGroup","children":{"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayLogGroup/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::Logs::LogGroup","aws:cdk:cloudformation:props":{"logGroupName":"/devquest/flyway","retentionInDays":7}},"constructInfo":{"fqn":"aws-cdk-lib.aws_logs.CfnLogGroup","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_logs.LogGroup","version":"2.196.1","metadata":[{"logGroupName":"*","retention":7,"removalPolicy":"destroy"}]}},"FlywaySG":{"id":"FlywaySG","path":"FlywayMigrationStack/FlywayMigrationTask/FlywaySG","children":{"Resource":{"id":"Resource","path":"FlywayMigrationStack/FlywayMigrationTask/FlywaySG/Resource","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroup","aws:cdk:cloudformation:props":{"groupDescription":"Security group for Flyway migration task","groupName":"devquest-flyway-migration-sg","securityGroupEgress":[{"cidrIp":"0.0.0.0/0","description":"Allow all outbound traffic by default","ipProtocol":"-1"}],"vpcId":"vpc-0b2365fd1215760aa"}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroup","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.SecurityGroup","version":"2.196.1","metadata":[{"vpc":"*","description":"*","allowAllOutbound":true,"securityGroupName":"*"}]}},"FlywayTaskDefinitionArn":{"id":"FlywayTaskDefinitionArn","path":"FlywayMigrationStack/FlywayMigrationTask/FlywayTaskDefinitionArn","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.196.1"}},"FlywaySecurityGroupId":{"id":"FlywaySecurityGroupId","path":"FlywayMigrationStack/FlywayMigrationTask/FlywaySecurityGroupId","constructInfo":{"fqn":"aws-cdk-lib.CfnOutput","version":"2.196.1"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter":{"id":"SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","path":"FlywayMigrationStack/SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118.Parameter","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.196.1"}},"SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118":{"id":"SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118","path":"FlywayMigrationStack/SsmParameterValue:--devquest--database--sg-id:C96584B6-F00A-464E-AD19-53AFF4B05118","constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":[]}},"ImportedDbSG":{"id":"ImportedDbSG","path":"FlywayMigrationStack/ImportedDbSG","children":{"from FlywayMigrationStackFlywayMigrationTaskFlywaySG3FBA916E:5432":{"id":"from FlywayMigrationStackFlywayMigrationTaskFlywaySG3FBA916E:5432","path":"FlywayMigrationStack/ImportedDbSG/from FlywayMigrationStackFlywayMigrationTaskFlywaySG3FBA916E:5432","attributes":{"aws:cdk:cloudformation:type":"AWS::EC2::SecurityGroupIngress","aws:cdk:cloudformation:props":{"description":"Allow Flyway task to access RDS","fromPort":5432,"groupId":{"Ref":"SsmParameterValuedevquestdatabasesgidC96584B6F00A464EAD1953AFF4B05118Parameter"},"ipProtocol":"tcp","sourceSecurityGroupId":{"Fn::GetAtt":["FlywayMigrationTaskFlywaySG9B0A99D8","GroupId"]},"toPort":5432}},"constructInfo":{"fqn":"aws-cdk-lib.aws_ec2.CfnSecurityGroupIngress","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.Resource","version":"2.196.1","metadata":[]}},"CDKMetadata":{"id":"CDKMetadata","path":"FlywayMigrationStack/CDKMetadata","children":{"Default":{"id":"Default","path":"FlywayMigrationStack/CDKMetadata/Default","constructInfo":{"fqn":"aws-cdk-lib.CfnResource","version":"2.196.1"}}},"constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}},"BootstrapVersion":{"id":"BootstrapVersion","path":"FlywayMigrationStack/BootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnParameter","version":"2.196.1"}},"CheckBootstrapVersion":{"id":"CheckBootstrapVersion","path":"FlywayMigrationStack/CheckBootstrapVersion","constructInfo":{"fqn":"aws-cdk-lib.CfnRule","version":"2.196.1"}}},"constructInfo":{"fqn":"aws-cdk-lib.Stack","version":"2.196.1"}},"Tree":{"id":"Tree","path":"Tree","constructInfo":{"fqn":"constructs.Construct","version":"10.4.2"}}},"constructInfo":{"fqn":"aws-cdk-lib.App","version":"2.196.1"}}}